# استفاده از یک Image پایه رسمی Node.js
FROM node:22.13.1-alpine

# تنظیم دایرکتوری کاری داخل کانتینر
WORKDIR /usr/src/app

# کپی فایل‌های وابستگی پروژه
COPY package*.json ./

# نصب وابستگی‌های پروژه
RUN npm install

# کپی بقیه فایل‌های پروژه به دایرکتوری کاری
COPY . .

# اجازه دسترسی به پورتی که برنامه روی آن اجرا می‌شود
EXPOSE 3000

# اضافه کردن دسترسی به سیستم فایل برای جمع‌آوری متریک‌ها
ENV NODE_ENV=production

# دستور نهایی برای راه‌اندازی برنامه با PM2
CMD ["npm", "start"]